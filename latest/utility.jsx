function util_calc_timespan_in_days(strt,nd){//Set the two dates//~ nd=new Date()//~ var christmas=new Date(today.getFullYear(), 11, 25) //Month is 0-11 in JavaScript//~ if (today.getMonth()==11 && today.getDate()>25) //if Christmas has passed already//~ christmas.setFullYear(christmas.getFullYear()+1) //calculate next year's Christmas//Set 1 day in millisecondsvar one_day=1000*60*60*24;//Calculate difference btw the two dates, and convert to days//~ $.write(Math.ceil((strt.getTime()-nd.getTime())/(one_day)) + " days left until Christmas!");var days = Math.abs(Math.ceil((strt.getTime()-nd.getTime())/(one_day)));return days;}function util_alertProjectList(){	var txt = "";for(var i = 0; i < meta.db.projects.length; i++){	var p = meta.db.projects[i];	txt = txt + "id: "+p.id+ " title: "+p.title + " time: "+ p.datetimeStart+"\n";//~	 if(p.id == 1362 ){//~	 prjcts.push(p); //sel + p.toSource () + "\n";//~	 }//~	 if( p.id == 1173 ){//~	 p2 = p; //sel = sel + p.toSource () + "\n";//~	 }//~	 if( p.id == 1754){//~	 p3 = p; //sel = sel + p.toSource () + "\n";//~	 } 	}		   //~ alert(dt);alert(txt);		}function util_set_tint(fn){    // the regexp patterns to sort out files	// that cant be placed like images in indesign	// use JSON to keep it tidy	 var tint = false ;	 var flsList = new Array();//~	  flsList.push({"pattern":"\\.pdf","file":"pdf.jpg"});	 flsList.push({"pattern":"\\.mov","file":"mov.jpg","type":"movie"});	 flsList.push({"pattern":"\\.zip","file":"zip.jpg","type":"archive"});	 flsList.push({"pattern":"\\.rtf","file":"rtf.jpg","type":"text"});	 flsList.push({"pattern":"\\.dmg","file":"dmg.jpg","type":"archive"});			 for(var b = 0; b < flsList.length;b++){			var reg = new RegExp(flsList[b].pattern);			if(fn.match(reg)){//~ 				fn = flsList[b].file;             tint = true;                 break;                }else{             tint = false;                    }	   			}					return tint;    }function util_setFileType(fn){	// the regexp patterns to sort out files	// that cant be placed like images in indesign	// use JSON to keep it tidy	 var type = null;	 var flsList = new Array();	  flsList.push({"pattern":"\\.pdf","file":"pdf.jpg","type":"pdf"});	 flsList.push({"pattern":"\\.mov","file":"mov.jpg","type":"movie"});	 flsList.push({"pattern":"\\.zip","file":"zip.jpg","type":"archive"});	 flsList.push({"pattern":"\\.rtf","file":"rtf.jpg","type":"text"});	 flsList.push({"pattern":"\\.dmg","file":"dmg.jpg","type":"archive"});			 for(var b = 0; b < flsList.length;b++){			var reg = new RegExp(flsList[b].pattern);			if(fn.match(reg)){//~ 				fn = flsList[b].file;             type = flsList[b].type                 break;                }else{             type = "image";                    }	   			}					return type;	}function util_checkFileType(fn){	// the regexp patterns to sort out files	// that cant be placed like images in indesign	// use JSON to keep it tidy	 	 var flsList = new Array();//~	  flsList.push({"pattern":"\\.pdf","file":"pdf.jpg"});	 flsList.push({"pattern":"\\.mov","file":"mov.jpg"});	 flsList.push({"pattern":"\\.zip","file":"zip.jpg"});	 flsList.push({"pattern":"\\.rtf","file":"rtf.jpg"});	 flsList.push({"pattern":"\\.dmg","file":"dmg.jpg"});			 for(var b = 0; b < flsList.length;b++){			var reg = new RegExp(flsList[b].pattern);			if(fn.match(reg)){				fn = flsList[b].file;				}			}                // replace the pngs with jpg	var pt = "\\.png";    var r = new RegExp(pt);    if(fn.match(r)){        var newName = fn.substr(0,fn.length - 4) + ".jpg";//~         alert(newName);        fn = newName;		}    	var pt2 = "\\.pdf";    var r2 = new RegExp(pt2);    if(fn.match(r2)){        var newName = fn.substr(0,fn.length - 4) + ".jpg";//~         alert(newName);        fn = newName;		}    	return fn;	}// this function sorts by time// found here// http://stackoverflow.com/questions/3859239/sort-json-by-datefunction util_custom_sort(a, b) {	return new Date(util_iso_to_datim(a.datetimeStart)).getTime() - 	new Date(util_iso_to_datim(b.datetimeStart)).getTime();}// found here// http://www.topsoft.at/pstrainer/pstrainer.phpfunction util_iso_to_datim(iso) {var d=null;var len=iso.length;	if(len>=19) {		var hh = parseInt(iso.substr(11,2),10);		var mi = parseInt(iso.substr(14,2),10);		var ss = parseInt(iso.substr(17,2),10);		}else {			var hh=0;			var mi=0;			var ss=0;			}		if(len>=10) {		var yy = parseInt(iso.substr(0,4),10);		var mo = parseInt(iso.substr(5,2),10)-1;		var dd = parseInt(iso.substr(8,2),10);		d = new Date(yy,mo,dd,hh,mi,ss);		}else{			d=new Date();    }return d;}function util_checkhighlite(id){		var bool = false;	for(var i = 0; i < meta.highlite.length; i++){				if(id == meta.highlite[i].id && id != 0){			bool = true;			break			}				}	return bool;	}function util_makeHyperlink(aPrefix, myArray) { 	for (var i = myArray.length-1; i >= 0; i-- ) { 		try{   			var aString = aPrefix + myArray[i].contents.replace(aPrefix,  '') 			var myHyperlinkTextSource = app.activeDocument.hyperlinkTextSources.add(myArray[i]);    			var myHyperlinkDestination = app.activeDocument.hyperlinkURLDestinations.add({destinationURL:aString}); 			var myHyperlink = app.activeDocument.hyperlinks.add({source:myHyperlinkTextSource,   destination:myHyperlinkDestination});    			//myHyperlink.visible = true;   		}   		catch(e){}  	}  } 